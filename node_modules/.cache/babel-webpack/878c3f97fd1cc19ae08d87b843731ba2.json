{"ast":null,"code":"// Licensed to the Software Freedom Conservancy (SFC) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The SFC licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n'use strict';\n/**\n * @fileoverview Factory methods for the supported locator strategies.\n */\n\n/**\n * Short-hand expressions for the primary element locator strategies.\n * For example the following two statements are equivalent:\n *\n *     var e1 = driver.findElement(By.id('foo'));\n *     var e2 = driver.findElement({id: 'foo'});\n *\n * Care should be taken when using JavaScript minifiers (such as the\n * Closure compiler), as locator hashes will always be parsed using\n * the un-obfuscated properties listed.\n *\n * @typedef {(\n *     {className: string}|\n *     {css: string}|\n *     {id: string}|\n *     {js: string}|\n *     {linkText: string}|\n *     {name: string}|\n *     {partialLinkText: string}|\n *     {tagName: string}|\n *     {xpath: string})}\n */\n\nvar ByHash;\n/**\n * Error thrown if an invalid character is encountered while escaping a CSS\n * identifier.\n * @see https://drafts.csswg.org/cssom/#serialize-an-identifier\n */\n\nclass InvalidCharacterError extends Error {\n  constructor() {\n    super();\n    this.name = this.constructor.name;\n  }\n\n}\n/**\n * Escapes a CSS string.\n * @param {string} css the string to escape.\n * @return {string} the escaped string.\n * @throws {TypeError} if the input value is not a string.\n * @throws {InvalidCharacterError} if the string contains an invalid character.\n * @see https://drafts.csswg.org/cssom/#serialize-an-identifier\n */\n\n\nfunction escapeCss(css) {\n  if (typeof css !== 'string') {\n    throw new TypeError('input must be a string');\n  }\n\n  let ret = '';\n  const n = css.length;\n\n  for (let i = 0; i < n; i++) {\n    const c = css.charCodeAt(i);\n\n    if (c == 0x0) {\n      throw new InvalidCharacterError();\n    }\n\n    if (c >= 0x0001 && c <= 0x001F || c == 0x007F || i == 0 && c >= 0x0030 && c <= 0x0039 || i == 1 && c >= 0x0030 && c <= 0x0039 && css.charCodeAt(0) == 0x002D) {\n      ret += '\\\\' + c.toString(16) + ' ';\n      continue;\n    }\n\n    if (i == 0 && c == 0x002D && n == 1) {\n      ret += '\\\\' + css.charAt(i);\n      continue;\n    }\n\n    if (c >= 0x0080 || c == 0x002D // -\n    || c == 0x005F // _\n    || c >= 0x0030 && c <= 0x0039 // [0-9]\n    || c >= 0x0041 && c <= 0x005A // [A-Z]\n    || c >= 0x0061 && c <= 0x007A) {\n      // [a-z]\n      ret += css.charAt(i);\n      continue;\n    }\n\n    ret += '\\\\' + css.charAt(i);\n  }\n\n  return ret;\n}\n/**\n * Describes a mechanism for locating an element on the page.\n * @final\n */\n\n\nclass By {\n  /**\n   * @param {string} using the name of the location strategy to use.\n   * @param {string} value the value to search for.\n   */\n  constructor(using, value) {\n    /** @type {string} */\n    this.using = using;\n    /** @type {string} */\n\n    this.value = value;\n  }\n  /**\n   * Locates elements that have a specific class name.\n   *\n   * @param {string} name The class name to search for.\n   * @return {!By} The new locator.\n   * @see http://www.w3.org/TR/2011/WD-html5-20110525/elements.html#classes\n   * @see http://www.w3.org/TR/CSS2/selector.html#class-html\n   */\n\n\n  static className(name) {\n    let names = name.split(/\\s+/g).filter(s => s.length > 0).map(s => escapeCss(s));\n    return By.css('.' + names.join('.'));\n  }\n  /**\n   * Locates elements using a CSS selector.\n   *\n   * @param {string} selector The CSS selector to use.\n   * @return {!By} The new locator.\n   * @see http://www.w3.org/TR/CSS2/selector.html\n   */\n\n\n  static css(selector) {\n    return new By('css selector', selector);\n  }\n  /**\n   * Locates elements by the ID attribute. This locator uses the CSS selector\n   * `*[id=\"$ID\"]`, _not_ `document.getElementById`.\n   *\n   * @param {string} id The ID to search for.\n   * @return {!By} The new locator.\n   */\n\n\n  static id(id) {\n    return By.css('*[id=\"' + escapeCss(id) + '\"]');\n  }\n  /**\n   * Locates link elements whose\n   * {@linkplain webdriver.WebElement#getText visible text} matches the given\n   * string.\n   *\n   * @param {string} text The link text to search for.\n   * @return {!By} The new locator.\n   */\n\n\n  static linkText(text) {\n    return new By('link text', text);\n  }\n  /**\n   * Locates an elements by evaluating a\n   * {@linkplain webdriver.WebDriver#executeScript JavaScript expression}.\n   * The result of this expression must be an element or list of elements.\n   *\n   * @param {!(string|Function)} script The script to execute.\n   * @param {...*} var_args The arguments to pass to the script.\n   * @return {function(!./webdriver.WebDriver): !./promise.Promise}\n   *     A new JavaScript-based locator function.\n   */\n\n\n  static js(script, var_args) {\n    let args = Array.prototype.slice.call(arguments, 0);\n    return function (driver) {\n      return driver.executeScript.apply(driver, args);\n    };\n  }\n  /**\n   * Locates elements whose `name` attribute has the given value.\n   *\n   * @param {string} name The name attribute to search for.\n   * @return {!By} The new locator.\n   */\n\n\n  static name(name) {\n    return By.css('*[name=\"' + escapeCss(name) + '\"]');\n  }\n  /**\n   * Locates link elements whose\n   * {@linkplain webdriver.WebElement#getText visible text} contains the given\n   * substring.\n   *\n   * @param {string} text The substring to check for in a link's visible text.\n   * @return {!By} The new locator.\n   */\n\n\n  static partialLinkText(text) {\n    return new By('partial link text', text);\n  }\n  /**\n   * Locates elements with a given tag name.\n   *\n   * @param {string} name The tag name to search for.\n   * @return {!By} The new locator.\n   * @deprecated Use {@link By.css() By.css(tagName)} instead.\n   */\n\n\n  static tagName(name) {\n    return By.css(name);\n  }\n  /**\n   * Locates elements matching a XPath selector. Care should be taken when\n   * using an XPath selector with a {@link webdriver.WebElement} as WebDriver\n   * will respect the context in the specified in the selector. For example,\n   * given the selector `//div`, WebDriver will search from the document root\n   * regardless of whether the locator was used with a WebElement.\n   *\n   * @param {string} xpath The XPath selector to use.\n   * @return {!By} The new locator.\n   * @see http://www.w3.org/TR/xpath/\n   */\n\n\n  static xpath(xpath) {\n    return new By('xpath', xpath);\n  }\n  /** @override */\n\n\n  toString() {\n    // The static By.name() overrides this.constructor.name.  Shame...\n    return `By(${this.using}, ${this.value})`;\n  }\n\n}\n/**\n * Checks if a value is a valid locator.\n * @param {!(By|Function|ByHash)} locator The value to check.\n * @return {!(By|Function)} The valid locator.\n * @throws {TypeError} If the given value does not define a valid locator\n *     strategy.\n */\n\n\nfunction check(locator) {\n  if (locator instanceof By || typeof locator === 'function') {\n    return locator;\n  }\n\n  if (locator && typeof locator === 'object' && typeof locator.using === 'string' && typeof locator.value === 'string') {\n    return new By(locator.using, locator.value);\n  }\n\n  for (let key in locator) {\n    if (locator.hasOwnProperty(key) && By.hasOwnProperty(key)) {\n      return By[key](locator[key]);\n    }\n  }\n\n  throw new TypeError('Invalid locator');\n} // PUBLIC API\n\n\nmodule.exports = {\n  By: By,\n  checkedLocator: check\n};","map":null,"metadata":{},"sourceType":"script"}